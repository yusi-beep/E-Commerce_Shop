{% load static %}

<!doctype html>
<html lang="bg">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}Магазин{% endblock %}</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/shop.css' %}">
  {% block extra_head %}{% endblock %}
  
  <!-- Favicon tags -->
  {% if site_branding.favicon %}
    {{ site_branding.get_favicon_html_tags }}
  {% else %}
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABmJLR0T///////8JWPfcAAAACXBIWXMAAABIAAAASABGyWs+AAAAF0lEQVRIx2NgGAWjYBSMglEwCkbBSAcACBAAAeaR9cIAAAAASUVORK5CYII=">
  {% endif %}
  
  <style>
    .badge { display:inline-block; padding:0.15rem 0.5rem; border-radius:9999px; font-size:0.8rem; background:#e53935; color:#fff; }
    .price-row { display:flex; gap:0.5rem; align-items:baseline; }
    .price-row small { opacity:0.75; }
    
    /* Modern Navbar Styling */
    .navbar {
      background: var(--gradient-card, linear-gradient(145deg, #ffffff, #f8fafc));
      border-bottom: 1px solid var(--border, rgba(0,0,0,.08));
      box-shadow: 0 2px 8px rgba(0,0,0,.06);
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    
    .navbar-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.75rem 1rem;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .navbar-brand {
      display: flex;
      align-items: center;
      text-decoration: none;
      color: inherit;
      font-weight: 600;
      font-size: 1.2rem;
    }
    
    .navbar-logo {
      height: auto;
      border-radius: 8px;
      transition: transform 0.2s ease;
    }
    
    .navbar-brand:hover .navbar-logo {
      transform: scale(1.05);
    }
    
    .navbar-brand:focus {
      outline: 2px solid var(--accent, #2563eb);
      outline-offset: 2px;
      border-radius: 8px;
    }
    
    .navbar-actions {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    
    .btn-icon {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.6rem 1rem;
      border-radius: 10px;
      text-decoration: none;
      color: var(--muted, #424345);
      background: transparent;
      border: 1px solid transparent;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      font-weight: 500;
    }
    
    .btn-icon:hover {
      background: var(--accent-soft-1, rgba(37, 99, 235, 0.1));
      border-color: var(--accent, #2563eb);
      color: var(--accent, #2563eb);
      transform: translateY(-1px);
    }
    
    .btn-icon:focus {
      outline: 2px solid var(--accent, #2563eb);
      outline-offset: 2px;
    }
    
    .badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background: var(--danger, #dc2626);
      color: white;
      font-size: 0.75rem;
      font-weight: 600;
      padding: 2px 6px;
      border-radius: 999px;
      min-width: 18px;
      text-align: center;
      line-height: 1.2;
      animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    .mobile-menu-btn {
      display: none;
      background: none;
      border: none;
      cursor: pointer;
      padding: 0.5rem;
      border-radius: 8px;
      color: var(--muted, #424345);
    }
    
    .mobile-menu-btn:hover {
      background: var(--accent-soft-1, rgba(37, 99, 235, 0.1));
    }
    
    .mobile-menu-btn:focus {
      outline: 2px solid var(--accent, #2563eb);
      outline-offset: 2px;
    }
    
    /* Mobile responsiveness */
    @media (max-width: 768px) {
      .navbar-actions {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: white;
        border-top: 1px solid var(--border, rgba(0,0,0,.08));
        box-shadow: 0 4px 16px rgba(0,0,0,.1);
        flex-direction: column;
        padding: 1rem;
        gap: 0.5rem;
      }
      
      .navbar-actions.active {
        display: flex;
      }
      
      .mobile-menu-btn {
        display: block;
      }
      
      .btn-icon {
        width: 100%;
        justify-content: center;
        padding: 0.75rem;
      }
      
      .navbar-container {
        position: relative;
      }
    }
    
    /* Icon styles */
    .icon {
      width: 20px;
      height: 20px;
      fill: currentColor;
    }
  </style>
</head>
<body>
  <nav class="navbar" role="navigation" aria-label="Главна навигация">
    <div class="navbar-container">
      {% if site_branding.logo %}
        <a href="{{ site_branding.logo_link_target }}" class="navbar-brand" aria-label="{{ site_branding.logo_alt_text }}">
          <img src="{{ site_branding.logo.url }}" 
               alt="{{ site_branding.logo_alt_text }}"
               class="navbar-logo"
               style="max-width: {{ site_branding.logo_max_width }}px;"
               loading="eager"
               decoding="async">
        </a>
      {% else %}
        <a href="/" class="navbar-brand">Магазин</a>
      {% endif %}
      
      <div class="navbar-actions" id="navbarActions">
        <a href="/cart/" class="btn-icon" aria-label="Количка {% if cart_item_count > 0 %}({{ cart_item_count }} артикула){% endif %}">
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
            <path fill="currentColor" d="M17,18C15.89,18 15,18.89 15,20A2,2 0 0,0 17,22A2,2 0 0,0 19,20C19,18.89 18.1,18 17,18M1,2V4H3L6.6,11.59L5.24,14.04C5.09,14.32 5,14.65 5,15A2,2 0 0,0 7,17H19V15H7.42A0.25,0.25 0 0,1 7.17,14.75C7.17,14.7 7.18,14.66 7.2,14.63L8.1,13H15.55C16.3,13 16.96,12.58 17.3,11.97L20.88,5H6.27L4.77,2H1M7,18C5.89,18 5,18.89 5,20A2,2 0 0,0 7,22A2,2 0 0,0 9,20C9,18.89 8.1,18 7,18Z"/>
          </svg>
          <span>Количка</span>
          {% if cart_item_count > 0 %}
            <span class="badge" id="cartBadge">{{ cart_item_count }}</span>
          {% endif %}
        </a>
        
        <a href="/checkout/" class="btn-icon" aria-label="Поръчки">
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
            <path fill="currentColor" d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"/>
          </svg>
          <span>Поръчки</span>
        </a>
        
        {% if user.is_staff %}
          <a href="/admin/" class="btn-icon" aria-label="Администрация">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
              <path fill="currentColor" d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
            </svg>
            <span>Админ</span>
          </a>
        {% endif %}
      </div>
      
      <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Меню" aria-expanded="false">
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="currentColor" d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"/>
        </svg>
      </button>
    </div>
  </nav>
  
  <script>
    // Mobile menu toggle
    document.addEventListener('DOMContentLoaded', function() {
      const mobileMenuBtn = document.getElementById('mobileMenuBtn');
      const navbarActions = document.getElementById('navbarActions');
      
      if (mobileMenuBtn && navbarActions) {
        mobileMenuBtn.addEventListener('click', function() {
          const isExpanded = navbarActions.classList.contains('active');
          navbarActions.classList.toggle('active');
          mobileMenuBtn.setAttribute('aria-expanded', !isExpanded);
        });
        
        // Close mobile menu when clicking outside
        document.addEventListener('click', function(e) {
          if (!e.target.closest('.navbar-container')) {
            navbarActions.classList.remove('active');
            mobileMenuBtn.setAttribute('aria-expanded', 'false');
          }
        });
        
        // Close mobile menu on escape key
        document.addEventListener('keydown', function(e) {
          if (e.key === 'Escape' && navbarActions.classList.contains('active')) {
            navbarActions.classList.remove('active');
            mobileMenuBtn.setAttribute('aria-expanded', 'false');
            mobileMenuBtn.focus();
          }
        });
      }
    });
  </script>
  <main class="container" style="padding-top:.75rem; padding-bottom:1.25rem;">
    {% block content %}{% endblock %}
  </main>
  {% if messages %}
  <div class="container">
      <ul>
        {% for message in messages %}
          <li class="{{ message.tags }}">{{ message }}</li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}
  <footer class="site-footer">
    <div class="footer-top">
      <div class="footer-col">
        <h3>ИНФОРМАЦИЯ</h3>
        <ul>
          <li><a href="#">Нашите цени в евро</a></li>
          <li><a href="#">За нас</a></li>
          <li><a href="#">Общи Условия</a></li>
          <li><a href="#">Политика за лични данни</a></li>
          <li><a href="#">Политика за използване на бисквитки</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h3>&nbsp;</h3>
        <ul>
          <li><a href="#">Другите за нас</a></li>
          <li><a href="{% url 'checkout_view' %}">Поръчка и доставка</a></li>
          <li><a href="#">Информация за поръчка</a></li>
          <li><a href="#">Често задавани въпроси</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h3>ИДЕИ ЗА ВАС</h3>
        <ul>
          <li><a href="#">Полезна Информация</a></li>
        </ul>
        <h3 style="margin-top:1.25rem;">ПОСЛЕДВАЙТЕ НИ</h3>
        <div class="social">
          <a href="#" aria-label="Facebook" class="icon-link">
            <!-- FB SVG -->
            <svg viewBox="0 0 24 24" width="22" height="22" aria-hidden="true"><path fill="currentColor" d="M22 12a10 10 0 1 0-11.5 9.9v-7h-2.7V12h2.7V9.7c0-2.7 1.6-4.2 4-4.2 1.1 0 2.2.2 2.2.2v2.4h-1.3c-1.3 0-1.7.8-1.7 1.6V12h2.9l-.5 2.9h-2.4v7A10 10 0 0 0 22 12"/></svg>
            Facebook
          </a>
          <a href="#" aria-label="Instagram" class="icon-link">
            <!-- IG SVG -->
            <svg viewBox="0 0 24 24" width="22" height="22" aria-hidden="true"><path fill="currentColor" d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5Zm0 2a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V7a3 3 0 0 0-3-3H7Zm5 3.5A5.5 5.5 0 1 1 6.5 13 5.5 5.5 0 0 1 12 7.5Zm0 2A3.5 3.5 0 1 0 15.5 13 3.5 3.5 0 0 0 12 9.5Zm6.25-2.75a1.25 1.25 0 1 1-1.25 1.25 1.25 1.25 0 0 1 1.25-1.25Z"/></svg>
            Instagram
          </a>
          <a href="#" aria-label="YouTube" class="icon-link">
            <!-- YT SVG -->
            <svg viewBox="0 0 24 24" width="22" height="22" aria-hidden="true"><path fill="currentColor" d="M23.5 6.2a3 3 0 0 0-2.1-2.1C19.9 3.5 12 3.5 12 3.5s-7.9 0-9.4.6A3 3 0 0 0 .5 6.2 31.1 31.1 0 0 0 0 12a31.1 31.1 0 0 0 .6 5.8 3 3 0 0 0 2.1 2.1C4.1 20.5 12 20.5 12 20.5s7.9 0 9.4-.6a3 3 0 0 0 2.1-2.1A31.1 31.1 0 0 0 24 12a31.1 31.1 0 0 0-.5-5.8ZM9.5 15.5v-7l6 3.5-6 3.5Z"/></svg>
            YouTube
          </a>
        </div>
      </div>
    </div>

    <div class="footer-bottom">
      <div>© 2004 – {% now "Y" %} YosakaSoft. Всички права запазени.</div>
      <div class="locale">
        <img src="https://flagcdn.com/w20/bg.png" width="20" height="15" alt="BG" loading="lazy">
        <span>Български</span>
        <span class="caret">▾</span>
      </div>
    </div>
  </footer>
</body>
</html>